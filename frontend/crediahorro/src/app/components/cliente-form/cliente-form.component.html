<div class="container mt-4">
  <h2 class="mb-4">Nuevo Cliente</h2>

  <form (ngSubmit)="guardarCliente()" #clienteForm="ngForm" novalidate>
    <!-- Datos del Cliente -->
    <div class="mb-3">
      <label for="nombre" class="form-label">Nombre <span class="text-danger">*</span></label>
      <input
        type="text"
        id="nombre"
        class="form-control"
        [(ngModel)]="cliente.nombre"
        name="nombre"
        required
        #nombre="ngModel"
      />
      <div class="text-danger" *ngIf="nombre.invalid && nombre.touched">
        El nombre es obligatorio.
      </div>
    </div>

    <div class="mb-3">
      <label for="dni" class="form-label">DNI <span class="text-danger">*</span></label>
      <input
        type="number"
        id="dni"
        class="form-control"
        [(ngModel)]="cliente.dni"
        name="dni"
        required
        #dni="ngModel"
      />
      <div class="text-danger" *ngIf="dni.invalid && dni.touched">
        El DNI es obligatorio.
      </div>
    </div>

    <div class="mb-3">
      <label for="direccion" class="form-label">Dirección <span class="text-danger">*</span></label>
      <input
        type="text"
        id="direccion"
        class="form-control"
        [(ngModel)]="cliente.direccion"
        name="direccion"
        required
        #direccion="ngModel"
      />
      <div class="text-danger" *ngIf="direccion.invalid && direccion.touched">
        La dirección es obligatorio.
      </div>
    </div>

    <div class="mb-3">
      <label for="telefonoWhatsapp" class="form-label">N° WhatsApp <span class="text-danger">*</span></label>
      <input
        type="number"
        id="telefonoWhatsapp"
        class="form-control"
        [(ngModel)]="cliente.telefonoWhatsapp"
        name="telefonoWhatsapp"
        required
        #telefonoWhatsapp="ngModel"
      />
      <div class="text-danger" *ngIf="telefonoWhatsapp.invalid && telefonoWhatsapp.touched">
        El N° de Whatsapp es obligatorio.
      </div>
    </div>

    <div class="mb-4">
      <label for="correoElectronico" class="form-label">Email</label>
      <input
        type="email"
        id="correoElectronico"
        class="form-control"
        [(ngModel)]="cliente.correoElectronico"
        name="correoElectronico"
      />
    </div>

    <!-- Préstamos -->
    <h3 class="mb-3">Agregar Préstamo</h3>

    <div
      *ngFor="let prestamo of cliente.prestamos; let i = index"
      class="border p-3 mb-3 rounded bg-light"
    >
      <div class="row g-3 align-items-center">
        <div class="col-md-3">
          <label for="monto{{i}}" class="form-label">Monto <span class="text-danger">*</span></label>
          <input
            type="number"
            id="monto{{i}}"
            class="form-control"
            [(ngModel)]="prestamo.monto"
            name="prestamoMonto{{i}}"
            required
          />
        </div>

        <div class="col-md-3">
          <label for="tasa{{i}}" class="form-label">Tasa de Interés Mensual (%) <span class="text-danger">*</span></label>
          <input
            type="number"
            id="tasa{{i}}"
            class="form-control"
            [(ngModel)]="prestamo.tasaInteresMensual"
            name="prestamoTasa{{i}}"
            required
          />
        </div>

        <div class="col-md-3">
          <label for="cuotas{{i}}" class="form-label">Número de Cuotas <span class="text-danger">*</span></label>
          <input
            type="number"
            id="cuotas{{i}}"
            class="form-control"
            [(ngModel)]="prestamo.numeroCuotas"
            name="prestamoCuotas{{i}}"
            required
          />
        </div>

        <div class="col-md-3">
          <label for="fecha{{i}}" class="form-label">Fecha de Inicio <span class="text-danger">*</span></label>
          <input
            type="date"
            id="fecha{{i}}"
            class="form-control"
            [(ngModel)]="prestamo.fechaInicio"
            name="prestamoFecha{{i}}"
            required
          />
        </div>
      </div>

      <div class="mt-3 text-end">
        <button
          type="button"
          class="btn btn-danger btn-sm"
          (click)="eliminarPrestamo(i)"
        >
          <i class="bi bi-trash"></i> Eliminar Préstamo
        </button>
      </div>
    </div>

    <button
      type="button"
      class="btn btn-info mb-4"
      (click)="agregarPrestamo()"
    >
      <i class="bi bi-plus-circle"></i> Agregar Préstamo
    </button>

    <!-- Botones principales -->
    <div class="d-flex gap-2">
      <button
        type="submit"
        class="btn btn-success"
        [disabled]="clienteForm.invalid"
      >
        <i class="bi bi-save"></i> Guardar
      </button>
      <button
        type="button"
        routerLink="/clientes"
        class="btn btn-secondary"
      >
        <i class="bi bi-arrow-left"></i> Volver
      </button>
    </div>
  </form>
</div>
