<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-primary fw-bold">Clientes Registrados</h2>
    <button class="btn btn-outline-primary shadow-sm" routerLink="/clientes/nuevo">
      <i class="bi bi-person-plus"></i> Nuevo Cliente
    </button>
  </div>

  <div *ngFor="let mesAnio of clientesAgrupadosPorMes | keyvalue: sortByDateDesc" class="mb-4">
    <h4 class="mb-3 text-secondary border-bottom pb-1">{{ mesAnio.key }}</h4>

    <div class="row g-3">
      <div class="col-md-6 col-lg-4" *ngFor="let cliente of mesAnio.value">
        <div class="card cliente-card shadow-sm border-0 h-100 position-relative">
          <!-- Contenedor de badges -->
          <div class="badge-container position-absolute top-0 start-0 w-100 d-flex justify-content-between p-2">
    <span
      *ngIf="cliente.cuotaPendienteTexto"
      class="badge bg-danger">
      {{ cliente.cuotaPendienteTexto }}
    </span>
            <span
              *ngIf="cliente.estadoPrestamoMasReciente !== 'SIN_PRESTAMO'"
              class="badge"
              [ngClass]="{
        'bg-success': cliente.estadoPrestamoMasReciente === 'PAGADO',
        'bg-warning text-dark': cliente.estadoPrestamoMasReciente === 'ACTIVO'
      }">
      {{ cliente.estadoPrestamoMasReciente === 'PAGADO' ? 'Préstamo Pagado' : 'Préstamo Activo' }}
    </span>
          </div>

          <div class="card-body d-flex flex-column">
            <div class="d-flex align-items-center mb-2">
              <div class="icon-circle bg-primary text-white me-3">
                <i class="bi bi-person-circle fs-4"></i>
              </div>
              <h5 class="card-title mb-0">{{ cliente.nombre }}</h5>
            </div>

            <p class="mb-1"><i class="bi bi-credit-card-2-front"></i> DNI: <strong>{{ cliente.dni }}</strong></p>
            <p class="mb-1"><i class="bi bi-geo-alt"></i> {{ cliente.direccion }}</p>
            <p class="mb-1"><i class="bi bi-whatsapp"></i> {{ cliente.telefonoWhatsapp }}</p>
            <p class="mb-3"><i class="bi bi-envelope"></i> {{ cliente.correoElectronico }}</p>

            <div class="mt-auto d-flex justify-content-between">
              <a class="btn btn-outline-primary btn-sm" [routerLink]="['/clientes', 'prestamos', cliente.id]" title="Ver Préstamo">
                <i class="bi bi-book"></i> Ver Préstamo
              </a>
              <a class="btn btn-outline-secondary btn-sm" [routerLink]="['/clientes', 'editar', cliente.id]" title="Editar Cliente">
                <i class="bi bi-pencil"></i> Editar Cliente
              </a>
              <button class="btn btn-outline-danger btn-sm" (click)="eliminarCliente(cliente.id!)" title="Eliminar Cliente">
                <i class="bi bi-trash"></i> Eliminar Cliente
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
